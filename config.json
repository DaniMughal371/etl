{
    "source_db" : {
        "db_type" : "source",
        "db_vendor" : "oracle",
        "host" : "10.31.12.11",
        "port" : "1521",
        "database" : "rproods",
        "username" : "reportuser",
        "password" : "report"
    },
    "destination_db" : {
        "db_type" : "destination",
        "db_vendor" : "mssqlserver",
        "host" : "RETAILTEST",
        "port" : "1433",
        "database" : "etl",
        "username" : "sa",
        "password" : "123456"
    },
    "extract" : {
        "tables" : [
            {
                "table_name" : "invoice_items",
                "incremental" : 0,
                "query" : "SELECT D.INVC_POST_DATE,TO_CHAR(D.SUBSIDIARY_SID) AS SBS_SID,TO_CHAR(D.SID) AS DOC_SID,TO_CHAR(DI.INVN_SBS_ITEM_SID) AS ITEM_SID, DI.ITEM_TYPE,DI.ORIG_PRICE,DI.PRICE,DI.TAX_PERC,DI.TAX_AMT,DI.TAX2_PERC,DI.TAX2_AMT,DI.COST, SUM(CASE WHEN DI.ITEM_TYPE = 2 THEN -DI.QTY WHEN DI.ITEM_TYPE = 3 THEN 0 ELSE DI.QTY END) AS SOLD_QTY, SUM(CASE WHEN DI.ITEM_TYPE = 2 THEN -DI.QTY*DI.COST WHEN DI.ITEM_TYPE = 3 THEN 0 ELSE DI.QTY*DI.COST END) AS EXT_COST, SUM(CASE WHEN DI.ITEM_TYPE = 2 THEN -DI.QTY*DI.TAX_AMT WHEN DI.ITEM_TYPE = 3 THEN 0 ELSE DI.QTY*DI.TAX_AMT END) AS EXT_TAX, SUM(CASE WHEN DI.ITEM_TYPE = 2 THEN -DI.QTY*DI.TAX2_AMT WHEN DI.ITEM_TYPE = 3 THEN 0 ELSE DI.QTY*DI.TAX2_AMT END) AS EXT_TAX2, SUM(     DECODE(D.USE_VAT,1,DI.ORIG_PRICE-NVL(DI.ORIG_TAX_AMT,0),DI.ORIG_PRICE)*     (CASE WHEN DI.ITEM_TYPE = 2 THEN -DI.QTY WHEN DI.ITEM_TYPE = 3 THEN 0 ELSE DI.QTY END) ) AS GROSS_SALE, SUM(     DECODE(D.USE_VAT,1,DI.ORIG_PRICE,DI.ORIG_PRICE+NVL(DI.ORIG_TAX_AMT,0))*     (CASE WHEN DI.ITEM_TYPE = 2 THEN -DI.QTY WHEN DI.ITEM_TYPE = 3 THEN 0 ELSE DI.QTY END) ) AS GROSS_SALE_WT, SUM(     DECODE(D.USE_VAT,1,DI.PRICE-NVL(DI.TAX_AMT,0)-NVL(DI.TAX2_AMT,0),DI.PRICE)*     (CASE WHEN DI.ITEM_TYPE = 2 THEN -DI.QTY WHEN DI.ITEM_TYPE = 3 THEN 0 ELSE DI.QTY END) ) AS NET_SALE, SUM(     (DECODE(D.USE_VAT,1,DI.PRICE-NVL(DI.TAX_AMT,0)-NVL(DI.TAX2_AMT,0),DI.PRICE)*(1-NVL(D.DISC_PERC,0)/100))*     (CASE WHEN DI.ITEM_TYPE = 2 THEN -DI.QTY WHEN DI.ITEM_TYPE = 3 THEN 0 ELSE DI.QTY END) ) AS NET_SALE_WGD, SUM(     DECODE(D.USE_VAT,1,DI.PRICE,DI.PRICE+NVL(DI.TAX_AMT,0)+NVL(DI.TAX2_AMT,0))*     (CASE WHEN DI.ITEM_TYPE = 2 THEN -DI.QTY WHEN DI.ITEM_TYPE = 3 THEN 0 ELSE DI.QTY END) ) AS NET_SALE_WT, SUM(     (DECODE(D.USE_VAT,1,DI.PRICE,DI.PRICE+NVL(DI.TAX_AMT,0)+NVL(DI.TAX2_AMT,0))*(1-NVL(D.DISC_PERC,0)/100))*     (CASE WHEN DI.ITEM_TYPE = 2 THEN -DI.QTY WHEN DI.ITEM_TYPE = 3 THEN 0 ELSE DI.QTY END) ) AS NET_SALE_WT_WGD FROM RPS.DOCUMENT D INNER JOIN RPS.DOCUMENT_ITEM DI ON D.SID = DI.DOC_SID WHERE D.DOC_NO > 0 AND D.ORDER_DOC_NO IS NULL AND D.STATUS = 4 AND D.IS_HELD <> 1 AND D.RECEIPT_TYPE IN (0,1) AND DI.KIT_FLAG NOT IN (2,3) AND TRUNC(D.INVC_POST_DATE) >= TO_DATE('01/01/2025','MM/DD/YYYY') GROUP BY D.SUBSIDIARY_SID,D.SID,DI.INVN_SBS_ITEM_SID,DI.ITEM_TYPE,DI.ORIG_PRICE,DI.PRICE,DI.TAX_PERC,DI.TAX_AMT,DI.TAX2_PERC,DI.TAX2_AMT,DI.COST,D.INVC_POST_DATE"
            }
        ]
    }
}